{"ast":null,"code":"import React,{useState,useContext}from\"react\";import\"./Booking.css\";import{Form,FormGroup,ListGroup,Button,ListGroupItem,Alert}from\"reactstrap\";import{useNavigate}from\"react-router-dom\";import{AuthContext}from\"../../context/AuthContext\";import{BASE_URL}from\"../../utils/config\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Booking=_ref=>{let{tour,avgRating,totalRating,reviews}=_ref;const{price,title}=tour;const navigate=useNavigate();const{user}=useContext(AuthContext);const[booking,setBooking]=useState({userId:user&&user.username,userEmail:user&&user.email,tourName:title,fullName:\"\",phone:\"\",bookAt:\"\",groupSize:\"\"});const[isBookingSuccessful,setIsBookingSuccessful]=useState(false);const[isBookingFailed,setIsBookingFailed]=useState(false);const[isLoginAlertVisible,setIsLoginAlertVisible]=useState(false);const handleChange=async e=>{setBooking(prev=>({...prev,[e.target.id]:e.target.value}));};const handleClick=async e=>{e.preventDefault();try{if(!user){setIsLoginAlertVisible(true);return;}const response=await fetch(\"\".concat(BASE_URL,\"/booking\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},credentials:\"include\",body:JSON.stringify(booking)});if(response.ok){setIsBookingSuccessful(true);setIsBookingFailed(false);setBooking({...booking,fullName:\"\",phone:\"\",bookAt:\"\",groupSize:\"\"});setTimeout(()=>{navigate(\"/thank-you\");},1000);// 1-second delay before navigating to the \"thank you\" page\n}else{setIsBookingSuccessful(false);setIsBookingFailed(true);}}catch(error){setIsBookingSuccessful(false);setIsBookingFailed(true);}};// Get the current date in YYYY-MM-DD format\nconst currentDate=new Date().toISOString().split(\"T\")[0];const taxes=(0.05*price*(booking.groupSize||1)).toFixed(2);const total=(price*(booking.groupSize||1)*1.05).toFixed(2);return/*#__PURE__*/_jsxs(\"div\",{className:\"booking\",children:[isBookingSuccessful&&/*#__PURE__*/_jsx(Alert,{color:\"success\",children:\"Booking Successful\"}),isBookingFailed&&/*#__PURE__*/_jsx(Alert,{color:\"danger\",children:\"Failed to book. Please try again.\"}),isLoginAlertVisible&&/*#__PURE__*/_jsx(Alert,{color:\"warning\",children:\"Please login to proceed with the booking.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking__top d-flex align-items-center justify-content-between\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[\"$\",price,\" \",/*#__PURE__*/_jsx(\"span\",{children:\"/Per Person\"})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"tour__rating d-flex align-items-center gap-1\",children:[/*#__PURE__*/_jsx(\"i\",{className:\"ri-star-fill\"}),avgRating===0?null:avgRating,totalRating===0?/*#__PURE__*/_jsx(\"span\",{children:\"Not Rated\"}):/*#__PURE__*/_jsxs(\"span\",{children:[\"(\",reviews.length||0,\")\"]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking__form\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Information\"}),/*#__PURE__*/_jsxs(Form,{className:\"booking__info-form\",onSubmit:handleClick,children:[/*#__PURE__*/_jsx(FormGroup,{children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Full Name\",id:\"fullName\",required:true,onChange:handleChange,value:booking.fullName})}),/*#__PURE__*/_jsx(FormGroup,{children:/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Phone\",id:\"phone\",required:true,onChange:handleChange,value:booking.phone})}),/*#__PURE__*/_jsxs(FormGroup,{className:\"d-flex align-items-center gap-3\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"date\",placeholder:\"Date\",id:\"bookAt\",required:true,onChange:handleChange,value:booking.bookAt,min:currentDate// Set min attribute to current date\n}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",placeholder:\"Group Size\",id:\"groupSize\",required:true,onChange:handleChange,value:booking.groupSize})]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"booking__bottom\",children:[/*#__PURE__*/_jsxs(ListGroup,{children:[/*#__PURE__*/_jsxs(ListGroupItem,{className:\"border-0 px-0\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"d-flex align-items-center gap-1\",children:[\"$\",price,\" \",/*#__PURE__*/_jsx(\"i\",{className:\"ri-close-line\"}),booking.groupSize||1,\" Person\"]}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",price*(booking.groupSize||1)]})]}),/*#__PURE__*/_jsxs(ListGroupItem,{className:\"border-0 px-0\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Taxes\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",taxes]})]}),/*#__PURE__*/_jsxs(ListGroupItem,{className:\"border-0 px-0 total\",children:[/*#__PURE__*/_jsx(\"h5\",{children:\"Total\"}),/*#__PURE__*/_jsxs(\"span\",{children:[\"$\",total]})]})]}),/*#__PURE__*/_jsx(Button,{className:\"btn primary__btn w-100 mt-4\",onClick:handleClick,children:\"Book Now\"})]})]});};export default Booking;","map":{"version":3,"names":["React","useState","useContext","Form","FormGroup","ListGroup","Button","ListGroupItem","Alert","useNavigate","AuthContext","BASE_URL","jsx","_jsx","jsxs","_jsxs","Booking","_ref","tour","avgRating","totalRating","reviews","price","title","navigate","user","booking","setBooking","userId","username","userEmail","email","tourName","fullName","phone","bookAt","groupSize","isBookingSuccessful","setIsBookingSuccessful","isBookingFailed","setIsBookingFailed","isLoginAlertVisible","setIsLoginAlertVisible","handleChange","e","prev","target","id","value","handleClick","preventDefault","response","fetch","concat","method","headers","credentials","body","JSON","stringify","ok","setTimeout","error","currentDate","Date","toISOString","split","taxes","toFixed","total","className","children","color","length","onSubmit","type","placeholder","required","onChange","min","onClick"],"sources":["/home/soujanya/Music/frontend/src/Components/Booking/Booking.jsx"],"sourcesContent":["import React, { useState, useContext } from \"react\";\nimport \"./Booking.css\";\nimport { Form, FormGroup, ListGroup, Button, ListGroupItem, Alert } from \"reactstrap\";\nimport { useNavigate } from \"react-router-dom\";\nimport { AuthContext } from \"../../context/AuthContext\";\nimport { BASE_URL } from \"../../utils/config\";\n\nconst Booking = ({ tour, avgRating, totalRating, reviews }) => {\n  const { price, title } = tour;\n  const navigate = useNavigate();\n\n  const { user } = useContext(AuthContext);\n\n  const [booking, setBooking] = useState({\n    userId: user && user.username,\n    userEmail: user && user.email,\n    tourName: title,\n    fullName: \"\",\n    phone: \"\",\n    bookAt: \"\",\n    groupSize: \"\",\n  });\n\n  const [isBookingSuccessful, setIsBookingSuccessful] = useState(false);\n  const [isBookingFailed, setIsBookingFailed] = useState(false);\n  const [isLoginAlertVisible, setIsLoginAlertVisible] = useState(false);\n\n  const handleChange = async (e) => {\n    setBooking((prev) => ({ ...prev, [e.target.id]: e.target.value }));\n  };\n\n  const handleClick = async (e) => {\n    e.preventDefault();\n    try {\n      if (!user) {\n        setIsLoginAlertVisible(true);\n        return;\n      }\n\n      const response = await fetch(`${BASE_URL}/booking`, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        credentials: \"include\",\n        body: JSON.stringify(booking),\n      });\n\n      if (response.ok) {\n        setIsBookingSuccessful(true);\n        setIsBookingFailed(false);\n        setBooking({\n          ...booking,\n          fullName: \"\",\n          phone: \"\",\n          bookAt: \"\",\n          groupSize: \"\",\n        });\n        setTimeout(() => {\n          navigate(\"/thank-you\");\n        }, 1000); // 1-second delay before navigating to the \"thank you\" page\n      } else {\n        setIsBookingSuccessful(false);\n        setIsBookingFailed(true);\n      }\n    } catch (error) {\n      setIsBookingSuccessful(false);\n      setIsBookingFailed(true);\n    }\n  };\n\n  // Get the current date in YYYY-MM-DD format\n  const currentDate = new Date().toISOString().split(\"T\")[0];\n\n  const taxes = (0.05 * price * (booking.groupSize || 1)).toFixed(2);\n  const total = (price * (booking.groupSize || 1) * 1.05).toFixed(2);\n\n  return (\n    <div className=\"booking\">\n      {isBookingSuccessful && (\n        <Alert color=\"success\">\n          Booking Successful\n        </Alert>\n      )}\n\n      {isBookingFailed && (\n        <Alert color=\"danger\">\n          Failed to book. Please try again.\n        </Alert>\n      )}\n\n      {isLoginAlertVisible && (\n        <Alert color=\"warning\">\n          Please login to proceed with the booking.\n        </Alert>\n      )}\n\n      <div className=\"booking__top d-flex align-items-center justify-content-between\">\n        <h3>\n          ${price} <span>/Per Person</span>\n        </h3>\n        <span className=\"tour__rating d-flex align-items-center gap-1\">\n          <i className=\"ri-star-fill\"></i>\n          {avgRating === 0 ? null : avgRating}\n          {totalRating === 0 ? (\n            <span>Not Rated</span>\n          ) : (\n            <span>({reviews.length || 0})</span>\n          )}\n        </span>\n      </div>\n\n      <div className=\"booking__form\">\n        <h5>Information</h5>\n        <Form className=\"booking__info-form\" onSubmit={handleClick}>\n          <FormGroup>\n            <input\n              type=\"text\"\n              placeholder=\"Full Name\"\n              id=\"fullName\"\n              required\n              onChange={handleChange}\n              value={booking.fullName}\n            />\n          </FormGroup>\n          <FormGroup>\n            <input\n              type=\"number\"\n              placeholder=\"Phone\"\n              id=\"phone\"\n              required\n              onChange={handleChange}\n              value={booking.phone}\n            />\n          </FormGroup>\n          <FormGroup className=\"d-flex align-items-center gap-3\">\n            <input\n              type=\"date\"\n              placeholder=\"Date\"\n              id=\"bookAt\"\n              required\n              onChange={handleChange}\n              value={booking.bookAt}\n              min={currentDate} // Set min attribute to current date\n            />\n            <input\n              type=\"number\"\n              placeholder=\"Group Size\"\n              id=\"groupSize\"\n              required\n              onChange={handleChange}\n              value={booking.groupSize}\n            />\n          </FormGroup>\n        </Form>\n      </div>\n\n      <div className=\"booking__bottom\">\n        <ListGroup>\n          <ListGroupItem className=\"border-0 px-0\">\n            <h5 className=\"d-flex align-items-center gap-1\">\n              ${price} <i className=\"ri-close-line\"></i>\n              {booking.groupSize || 1} Person\n            </h5>\n            <span>${price * (booking.groupSize || 1)}</span>\n          </ListGroupItem>\n          <ListGroupItem className=\"border-0 px-0\">\n            <h5>Taxes</h5>\n            <span>${taxes}</span>\n          </ListGroupItem>\n\n          <ListGroupItem className=\"border-0 px-0 total\">\n            <h5>Total</h5>\n            <span>${total}</span>\n          </ListGroupItem>\n        </ListGroup>\n        <Button className=\"btn primary__btn w-100 mt-4\" onClick={handleClick}>\n          Book Now\n        </Button>\n      </div>\n    </div>\n  );\n};\n\nexport default Booking;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,UAAU,KAAQ,OAAO,CACnD,MAAO,eAAe,CACtB,OAASC,IAAI,CAAEC,SAAS,CAAEC,SAAS,CAAEC,MAAM,CAAEC,aAAa,CAAEC,KAAK,KAAQ,YAAY,CACrF,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,WAAW,KAAQ,2BAA2B,CACvD,OAASC,QAAQ,KAAQ,oBAAoB,CAAC,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,yBAE9C,KAAM,CAAAC,OAAO,CAAGC,IAAA,EAA+C,IAA9C,CAAEC,IAAI,CAAEC,SAAS,CAAEC,WAAW,CAAEC,OAAQ,CAAC,CAAAJ,IAAA,CACxD,KAAM,CAAEK,KAAK,CAAEC,KAAM,CAAC,CAAGL,IAAI,CAC7B,KAAM,CAAAM,QAAQ,CAAGf,WAAW,CAAC,CAAC,CAE9B,KAAM,CAAEgB,IAAK,CAAC,CAAGvB,UAAU,CAACQ,WAAW,CAAC,CAExC,KAAM,CAACgB,OAAO,CAAEC,UAAU,CAAC,CAAG1B,QAAQ,CAAC,CACrC2B,MAAM,CAAEH,IAAI,EAAIA,IAAI,CAACI,QAAQ,CAC7BC,SAAS,CAAEL,IAAI,EAAIA,IAAI,CAACM,KAAK,CAC7BC,QAAQ,CAAET,KAAK,CACfU,QAAQ,CAAE,EAAE,CACZC,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACVC,SAAS,CAAE,EACb,CAAC,CAAC,CAEF,KAAM,CAACC,mBAAmB,CAAEC,sBAAsB,CAAC,CAAGrC,QAAQ,CAAC,KAAK,CAAC,CACrE,KAAM,CAACsC,eAAe,CAAEC,kBAAkB,CAAC,CAAGvC,QAAQ,CAAC,KAAK,CAAC,CAC7D,KAAM,CAACwC,mBAAmB,CAAEC,sBAAsB,CAAC,CAAGzC,QAAQ,CAAC,KAAK,CAAC,CAErE,KAAM,CAAA0C,YAAY,CAAG,KAAO,CAAAC,CAAC,EAAK,CAChCjB,UAAU,CAAEkB,IAAI,GAAM,CAAE,GAAGA,IAAI,CAAE,CAACD,CAAC,CAACE,MAAM,CAACC,EAAE,EAAGH,CAAC,CAACE,MAAM,CAACE,KAAM,CAAC,CAAC,CAAC,CACpE,CAAC,CAED,KAAM,CAAAC,WAAW,CAAG,KAAO,CAAAL,CAAC,EAAK,CAC/BA,CAAC,CAACM,cAAc,CAAC,CAAC,CAClB,GAAI,CACF,GAAI,CAACzB,IAAI,CAAE,CACTiB,sBAAsB,CAAC,IAAI,CAAC,CAC5B,OACF,CAEA,KAAM,CAAAS,QAAQ,CAAG,KAAM,CAAAC,KAAK,IAAAC,MAAA,CAAI1C,QAAQ,aAAY,CAClD2C,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,WAAW,CAAE,SAAS,CACtBC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACjC,OAAO,CAC9B,CAAC,CAAC,CAEF,GAAIyB,QAAQ,CAACS,EAAE,CAAE,CACftB,sBAAsB,CAAC,IAAI,CAAC,CAC5BE,kBAAkB,CAAC,KAAK,CAAC,CACzBb,UAAU,CAAC,CACT,GAAGD,OAAO,CACVO,QAAQ,CAAE,EAAE,CACZC,KAAK,CAAE,EAAE,CACTC,MAAM,CAAE,EAAE,CACVC,SAAS,CAAE,EACb,CAAC,CAAC,CACFyB,UAAU,CAAC,IAAM,CACfrC,QAAQ,CAAC,YAAY,CAAC,CACxB,CAAC,CAAE,IAAI,CAAC,CAAE;AACZ,CAAC,IAAM,CACLc,sBAAsB,CAAC,KAAK,CAAC,CAC7BE,kBAAkB,CAAC,IAAI,CAAC,CAC1B,CACF,CAAE,MAAOsB,KAAK,CAAE,CACdxB,sBAAsB,CAAC,KAAK,CAAC,CAC7BE,kBAAkB,CAAC,IAAI,CAAC,CAC1B,CACF,CAAC,CAED;AACA,KAAM,CAAAuB,WAAW,CAAG,GAAI,CAAAC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,CAACC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAE1D,KAAM,CAAAC,KAAK,CAAG,CAAC,IAAI,CAAG7C,KAAK,EAAII,OAAO,CAACU,SAAS,EAAI,CAAC,CAAC,EAAEgC,OAAO,CAAC,CAAC,CAAC,CAClE,KAAM,CAAAC,KAAK,CAAG,CAAC/C,KAAK,EAAII,OAAO,CAACU,SAAS,EAAI,CAAC,CAAC,CAAG,IAAI,EAAEgC,OAAO,CAAC,CAAC,CAAC,CAElE,mBACErD,KAAA,QAAKuD,SAAS,CAAC,SAAS,CAAAC,QAAA,EACrBlC,mBAAmB,eAClBxB,IAAA,CAACL,KAAK,EAACgE,KAAK,CAAC,SAAS,CAAAD,QAAA,CAAC,oBAEvB,CAAO,CACR,CAEAhC,eAAe,eACd1B,IAAA,CAACL,KAAK,EAACgE,KAAK,CAAC,QAAQ,CAAAD,QAAA,CAAC,mCAEtB,CAAO,CACR,CAEA9B,mBAAmB,eAClB5B,IAAA,CAACL,KAAK,EAACgE,KAAK,CAAC,SAAS,CAAAD,QAAA,CAAC,2CAEvB,CAAO,CACR,cAEDxD,KAAA,QAAKuD,SAAS,CAAC,gEAAgE,CAAAC,QAAA,eAC7ExD,KAAA,OAAAwD,QAAA,EAAI,GACD,CAACjD,KAAK,CAAC,GAAC,cAAAT,IAAA,SAAA0D,QAAA,CAAM,aAAW,CAAM,CAAC,EAC/B,CAAC,cACLxD,KAAA,SAAMuD,SAAS,CAAC,8CAA8C,CAAAC,QAAA,eAC5D1D,IAAA,MAAGyD,SAAS,CAAC,cAAc,CAAI,CAAC,CAC/BnD,SAAS,GAAK,CAAC,CAAG,IAAI,CAAGA,SAAS,CAClCC,WAAW,GAAK,CAAC,cAChBP,IAAA,SAAA0D,QAAA,CAAM,WAAS,CAAM,CAAC,cAEtBxD,KAAA,SAAAwD,QAAA,EAAM,GAAC,CAAClD,OAAO,CAACoD,MAAM,EAAI,CAAC,CAAC,GAAC,EAAM,CACpC,EACG,CAAC,EACJ,CAAC,cAEN1D,KAAA,QAAKuD,SAAS,CAAC,eAAe,CAAAC,QAAA,eAC5B1D,IAAA,OAAA0D,QAAA,CAAI,aAAW,CAAI,CAAC,cACpBxD,KAAA,CAACZ,IAAI,EAACmE,SAAS,CAAC,oBAAoB,CAACI,QAAQ,CAAEzB,WAAY,CAAAsB,QAAA,eACzD1D,IAAA,CAACT,SAAS,EAAAmE,QAAA,cACR1D,IAAA,UACE8D,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,WAAW,CACvB7B,EAAE,CAAC,UAAU,CACb8B,QAAQ,MACRC,QAAQ,CAAEnC,YAAa,CACvBK,KAAK,CAAEtB,OAAO,CAACO,QAAS,CACzB,CAAC,CACO,CAAC,cACZpB,IAAA,CAACT,SAAS,EAAAmE,QAAA,cACR1D,IAAA,UACE8D,IAAI,CAAC,QAAQ,CACbC,WAAW,CAAC,OAAO,CACnB7B,EAAE,CAAC,OAAO,CACV8B,QAAQ,MACRC,QAAQ,CAAEnC,YAAa,CACvBK,KAAK,CAAEtB,OAAO,CAACQ,KAAM,CACtB,CAAC,CACO,CAAC,cACZnB,KAAA,CAACX,SAAS,EAACkE,SAAS,CAAC,iCAAiC,CAAAC,QAAA,eACpD1D,IAAA,UACE8D,IAAI,CAAC,MAAM,CACXC,WAAW,CAAC,MAAM,CAClB7B,EAAE,CAAC,QAAQ,CACX8B,QAAQ,MACRC,QAAQ,CAAEnC,YAAa,CACvBK,KAAK,CAAEtB,OAAO,CAACS,MAAO,CACtB4C,GAAG,CAAEhB,WAAa;AAAA,CACnB,CAAC,cACFlD,IAAA,UACE8D,IAAI,CAAC,QAAQ,CACbC,WAAW,CAAC,YAAY,CACxB7B,EAAE,CAAC,WAAW,CACd8B,QAAQ,MACRC,QAAQ,CAAEnC,YAAa,CACvBK,KAAK,CAAEtB,OAAO,CAACU,SAAU,CAC1B,CAAC,EACO,CAAC,EACR,CAAC,EACJ,CAAC,cAENrB,KAAA,QAAKuD,SAAS,CAAC,iBAAiB,CAAAC,QAAA,eAC9BxD,KAAA,CAACV,SAAS,EAAAkE,QAAA,eACRxD,KAAA,CAACR,aAAa,EAAC+D,SAAS,CAAC,eAAe,CAAAC,QAAA,eACtCxD,KAAA,OAAIuD,SAAS,CAAC,iCAAiC,CAAAC,QAAA,EAAC,GAC7C,CAACjD,KAAK,CAAC,GAAC,cAAAT,IAAA,MAAGyD,SAAS,CAAC,eAAe,CAAI,CAAC,CACzC5C,OAAO,CAACU,SAAS,EAAI,CAAC,CAAC,SAC1B,EAAI,CAAC,cACLrB,KAAA,SAAAwD,QAAA,EAAM,GAAC,CAACjD,KAAK,EAAII,OAAO,CAACU,SAAS,EAAI,CAAC,CAAC,EAAO,CAAC,EACnC,CAAC,cAChBrB,KAAA,CAACR,aAAa,EAAC+D,SAAS,CAAC,eAAe,CAAAC,QAAA,eACtC1D,IAAA,OAAA0D,QAAA,CAAI,OAAK,CAAI,CAAC,cACdxD,KAAA,SAAAwD,QAAA,EAAM,GAAC,CAACJ,KAAK,EAAO,CAAC,EACR,CAAC,cAEhBpD,KAAA,CAACR,aAAa,EAAC+D,SAAS,CAAC,qBAAqB,CAAAC,QAAA,eAC5C1D,IAAA,OAAA0D,QAAA,CAAI,OAAK,CAAI,CAAC,cACdxD,KAAA,SAAAwD,QAAA,EAAM,GAAC,CAACF,KAAK,EAAO,CAAC,EACR,CAAC,EACP,CAAC,cACZxD,IAAA,CAACP,MAAM,EAACgE,SAAS,CAAC,6BAA6B,CAACU,OAAO,CAAE/B,WAAY,CAAAsB,QAAA,CAAC,UAEtE,CAAQ,CAAC,EACN,CAAC,EACH,CAAC,CAEV,CAAC,CAED,cAAe,CAAAvD,OAAO","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}